## Determining Confounders

By now we know how to adjust for a confounder in our data. But how would
we go about determining what can be a confounder in the first place?

Confounders, by their very nature, are a relationship between variables.
It just so happens that those relationships affect the relationships we
want to see.

The easiest way to notice those relationships is to graph them. If a
confounder C is affecting the relationship between Y and S, there should
be a graphical trend between S and C. Luckily, DSLD provides a host of
functions that let you visually explore these trends.

### Graphical Examples

If you suspect that a couple variables may confound with your sensitive
variable, a quick way to view all of them at once is to plot them in a
3D scatter plot.

```{r}
data("law.school.admissions")
dsld::dsldScatterPlot3D(law.school.admissions, sName = "race1", 
  yNames=c("ugpa", "lsat","age"), xlim=c(2,4), maxPoints = 1500, pointSize = 4)
```

<!-- ![](graphTab/lawscatterplot3d.png){width="80%"} -->

As an example, this is the law.school.admissions data set, a survey of
students attending law school in 1991. In this scatter plot, we graphed
a student's race against their age, their current gpa, and their lsat
score. Most notably, you can see that the youngest people, those aged
30-40, are predominately white. This may mean that age confounds with
race to some extent, or it may not. But with this you have a good
jumping-off point for further analysis.

### Tabular Example

Sometimes our intuition may tell us that some feature may be a confounder 
when that may not be the case. For example, suppose we suspect that an 
employee's education level influences the causal effect that gender may 
have on wage.

One way to further affirm/deny this claim is by using the function
dsldFrequencyByS. It requires 2 input columns, with the latter being
the sensitive variable. This function aims to analyze categorical (not
numeric) columns by printing out a list of frequencies. Since education 
level is categorical, we can call the function as follows:

```{r}
library(dsld)
data(svcensus)
dsldFrequencyByS(svcensus, "educ", "gender")
```

If our table had produced raw counts instead of proportions, we would see 
a major difference in the number of males vs females with an education level 
of 16, but displaying proportions shows us that this difference is only due to 
the fact that there are more males than females in the data. Since the proportions 
are similar, we cannot confidently claim education to be a possible confounder.

On the other hand, we *do* see more interesting results if we look at *occupation* 
instead of *education*:

```{r}
library(dsld)
data(svcensus)
dsldFrequencyByS(svcensus, "occ", "gender")
```

Notice the difference between the proportion of males in occupation 106 vs females 
in that same occupation -- a difference of approximately 11%. The difference in 
frequencies here are much greater than with the 'educ' example, which suggests that 
there is a difference in the occupations that men and women tend to be in; since 
different occupations can have different wages, it is possible that this difference 
in men occupations vs women occupations could be affecting the relationship between 
gender and wage. In this example, occupation may be a confounder; more investigation 
will be needed to further support (or disprove) this claim.
