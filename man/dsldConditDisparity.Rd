\name{dsldConditDisparity}
\alias{dsldConditDisparity}
\title{dsldConditDisparity}

\description{
    Plots (estimated) mean Y against X, separately for each level of S,
    with restrictions `condits`. May reveal Simpson's Paradox-like
    differences not seen in merely plotting mean Y against X.
}

\usage{
    dsldConditDisparity <- function(data, yName, sName, xName, condits,
                                qeFtn = qeKNN, minS = 50, useLoess = TRUE)
}

\arguments{
   \item{data}{Dataframe or equivalent}
   \item{yName}{As in qeML functions, predicted variable, must be numeric 
      or dichtomous R factor.}
   \item{sName}{Name of the sensitive variable, an R factor}
   \item{xName}{Name of a numeric column for the X-axis.}
   \item{condits}{An R vector; each component is a character 
      string for an R logical expression representing a desired 
      condition involving \code{names(data) other than S and Y.}}
   \item{qeFtn}{qeML predictive function function (only default arguments
      will be used.)}
   \item{minS}{Minimum size for an S group to be retained in the analysis.}
   \item{useLoess}{if TRUE, do loess smoothing on the fitted regression values.}
}

\author{
    N. Matloff, A. Ashok, S. Martha, A. Mittal
}

\examples{

    compas <- fairml::compas
    compas$two_year_recid <- as.numeric(compas$two_year_recid == "Yes")
    dsldConditDisparity(compas,"two_year_recid", "race", "age", 
       c("priors_count <= 4","decile_score>=6"), qeKNN)

    compas <- fairml::compas
    compas$two_year_recid <- as.numeric(compas$two_year_recid == "Yes")
    dsldConditDisparity(compas,"two_year_recid", "race", "age", 
         c("priors_count <= 4","decile_score>=6"), qeGBoost)

    # figures functionality coming soon
    # \figure{
    #   \includegraphics{man/Example2.png}
    #   \label{Example 2 Plot}
    # }

    #    As you can see the curves generated by \code{qeGBoost} are similar to 
    #    the curves in Example 1 using \code{qeKNN}. The use of any of the qeML 
    #    functions should give similar plots.

    #    Example 3:
    #    Let's investigate the statistics about RECIDIVISM that generalize 
    #    across sex and fail to take into account specifics about underlying 
    #    differences between subgroups (i.e. Female, Male).
    #
    #    First, choose the COMPAS dataset. Make sure to convert the yName column 
    #    to numeric before calling the function.
    #    The function arguments here are (data = compas, 
    #       yName = "two_year_recid", sName = "sex", xName = "age", 
    #       condits = c("priors_count <= 4","decile_score>=6"), qeFtn = qeKNN).

    compas <- fairml::compas
    compas$two_year_recid <- as.numeric(compas$two_year_recid == "Yes")
    dsldConditDisparity(compas,"two_year_recid","sex","age",
         c("priors_count <= 4","decile_score>=6"),qeKNN)

    # figures functionality coming soon
    # \figure{
    #   \includegraphics{man/Example3.png}
    #   \label{Example 3 Plot}
    # }

    #    The blue (Female) curve exhibits the behavior that during middle age, 
    #    the probability of recidivism inclines. But the red curve (Male) shows 
    #    the opposite. This shows the importance of exploring interactions 
    #    between variables. Otherwise, we would have generalized that the 
    #    probability of recidivism declines during middle age for both sexes.
}

